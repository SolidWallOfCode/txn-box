meta:
  version: "1.0"

  txn_box:
  - when: ua-req
    do:
    - var<Best-Band>: "Delain"

  - when: proxy-rsp
    do:
      with: ua-req-path
      select:
      - match: "2"
        do:
        - proxy-rsp-field<Best-Band>: var<Best-Band>

  blocks:
  - base_request: &base_request
      version: "1.1"
      scheme: "http"
      method: "GET"

sessions:
- protocol: [ ipv4, tcp ]
  transactions:
  - all: { headers: { fields: [[ uuid, 1 ]]}}
    client-request:
      <<: *base_request
      url: "/1"
      headers:
        fields:
        - [ Host, example.one ]
    proxy-request:
      headers:
        fields:
        - [ Host, example.one ]
    server-response:
      status: 200
      reason: OK
      content:
        size: 234
      headers:
        fields:
        - [ Content-Type, html/plaintext ]
        - [ Content-Length, 234 ]
    proxy-response:
      headers:
        fields:
        - [ Best-Band, Delain, absent ]

  - all: { headers: { fields: [[ uuid, 2 ]]}}
    client-request:
      <<: *base_request
      url: "/2"
      headers:
        fields:
        - [ Host, example.one ]
    proxy-request:
      headers:
        fields:
        - [ Host, example.one ]
    server-response:
      status: 200
      reason: OK
      content:
        size: 234
      headers:
        fields:
        - [ Content-Type, html/plaintext ]
        - [ Content-Length, 234 ]
    proxy-response:
      headers:
        fields:
        - [ Best-Band, Delain, equal ]
